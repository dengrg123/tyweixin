<!DOCTYPE html >
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:th="http://www.thymeleaf.org"
	xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity3">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />

<link rel="apple-touch-icon" href="/gomobile/2/images/apple-touch-icon.png" />
<link rel="apple-touch-startup-image" href="/gomobile/2/images/apple-touch-startup-image-320x460.png" />

<title>华南农业大学</title>
<link type="text/css" rel="stylesheet" href="/layui/css/layui.css"/>
<link type="text/css" rel="stylesheet" href="/gomobile/2/css/style.css"/>
<link type="text/css" rel="stylesheet" href="/gomobile/2/colors/medical/medical.css"/>
<link type="text/css" rel="stylesheet" href="/gomobile/2/css/idangerous.swiper.css"/>
<link type="text/css" rel="stylesheet" href="/gomobile/2/css/swipebox.css"/>
<link href="/gomobile/2/js/mobiscroll/dev/css/mobiscroll.core-2.6.2.css" rel="stylesheet" type="text/css" />
<link href="/gomobile/2/js/mobiscroll/dev/css/mobiscroll.animation-2.6.2.css" rel="stylesheet" type="text/css" />
<link href="/gomobile/2/js/mobiscroll/dev/css/mobiscroll.animation-2.6.2.css" rel="stylesheet" type="text/css" />

<style type="text/css">
	*{font-family:微软雅黑;}
	.textp{
	border-bottom: 1px #ddd dashed;
	 text-indent:2em; 
	width: 100%;
 	margin:0px;padding:0px;
    padding: 0 0 5px 0;
    margin: 0 0 5px 0;}
    .titlep{
    	font-weight:bold;
    	margin:0px;padding:0px;
    }
    .portfolio_image{text-align: center}
    .portfolio_image img{margin-bottom: 7px;}
    .style_a{
    	margin-right:20px;
    }

  
</style>
</head>
<body>


  <div id="header">

      <div class="gohome">
      <a href="/pages/toEquipmentList"><img src="/gomobile/2/images/icons/home.png" alt="" title="" /></a>
      </div>
   		<div  class="gomenu2" style="line-height: 45px;float: left" th:if="${session.loginInfo!=null?true:false}">
   			<a href="/appointment/toAppoList" th:if="${session.loginInfo['account']!='sysadmin' and (session.isManager==null or !session.isManager)}">我的预约</a>
   			<a href="/manager/toAppointmentList" th:if="${session.loginInfo['account']=='sysadmin' or (session.isManager!=null and session.isManager)}">我的审批</a>
   		</div>
      <div class="gomenu2" style="line-height: 45px;;float: right;">
      <span th:if="${session.loginInfo!=null?true:false}" th:text="'欢迎【'+${session.loginInfo['name']!=null?session.loginInfo['name']:session.loginInfo['account']}+'】'"></span>
      <a href="/pages/toLogin"  th:if="${session.loginInfo==null}">登录</a>
      <a href="/doLogout"  th:if="${session.loginInfo!=null}">退出</a>
      </div>

  </div>

      <div class="swiper-container swiper-parent">
    <div class="swiper-wrapper">

      <div class="swiper-slide sliderbg swiper-slide-visible swiper-slide-active">
      <div class="swiper-container swiper-nested4">
               <div class="swiper-wrapper">
                    <div class="swiper-slide">
                      
                              <div class="slide-inner">
                                        <div class="pages_container">
                                        <h2 class="page_title">设备列表</h2>
                                        <div class="toogle_wrap">
                                            <div class="trigger"><a href="#">条件筛选</a></div>
                                            <div class="toggle_container" style="display:none">
										 <div class="form">
			                                <form action="">
			                                <label style="font-size: 14px">学科：</label>
			                                <input type="text" id="subjectName"  class="form_input"/>
			                                <label style="font-size: 14px">类型：</label>
			                                <input type="text"  id="typeName" class="form_input"/>
			                                <a  href="#" th:each="model:${deptListTop10}" th:inline="text" onclick='changeBg(this)'  class="button_13 green green_borderbottom">
			                                          [[${model['name']}]]
			                                          <input type="hidden" name="deptid"  th:value="${model['ID']}"/>
			                                 </a>
												<a  href="javascript:void(0)" onclick="moreDept(this)" th:if="${deptList!=null and !deptList.isEmpty()}" style="float:right;margin-top:10px;">更多...</a>
												 <a href="#" onclick="getData(this.parentNode)" class="button_14 bluegreen bluegreen_borderbottom">搜　索</a>
			                                </form>
			                                </div>
                                            </div>
                                        </div>
                                     
                                        <div class="clearfix"></div>
      									<div class="scrolltop"><a href="#" class="scrolltop4"><img src="/gomobile/2/images/icons/top.png" alt="Go on top" title="Go on top" /></a></div>
                                        </div>
                                        
                                        <!--End of page container-->
                              </div>
                    </div>
              </div>
              <div class="swiper-scrollbar4"></div>
     </div>
     </div>
     
 
      <!--Page 6 content-->
     
  <div class="pagination"></div>
  </div>
  
  </div>
<script type="text/javascript" src="/gomobile/2/js/jquery-1.10.1.min.js"></script>
<script type="text/javascript" src="/gomobile/2/js/jquery.swipebox.js"></script>
<script type="text/javascript" src="/gomobile/2/js/idangerous.swiper-2.1.min.js"></script>
<script type="text/javascript" src="/gomobile/2/js/idangerous.swiper.scrollbar-2.1.js"></script>
 <script src="/gomobile/2/js/mobiscroll/dev/js/mobiscroll.core-2.6.2.js" type="text/javascript"></script>
<script src="/gomobile/2/js/mobiscroll/dev/js/mobiscroll.core-2.6.2-zh.js" type="text/javascript"></script>
<script src="/gomobile/2/js/mobiscroll/dev/js/mobiscroll.datetime-2.6.2.js" type="text/javascript"></script>
<script type="text/javascript" src="/gomobile/2/js/code.js"></script>
<script type="text/javascript" src="/gomobile/2/js/load.js"></script>
<script type="text/javascript" src="/layui/layui.js"></script>
<script type="text/javascript"  th:inline="javascript">
	var isLogin= /*[[${session.loginInfo!=null?true:false}]]*/;
	/* <![CDATA[*/
	var otherDept= /*[[${deptList}]]*/
	var layer = null;
	function toCirs(eid){

		
		layer.open({
			  type: 2, 
			  area: ['90%','498px'],
			 
			  content: '/pages/toEquipmentCircs?equipmentid='+eid //这里content是一个URL，如果你不想让iframe出现滚动条，你还可以content: ['http://sentsin.com', 'no']
		});
	}

	
	function moreDept(obj){
		if($(".md").length==0){
			var deptsObj=eval("("+otherDept+")");
			
			for(var i=0;i<deptsObj.length;i++)
			{
				$(obj).before("<a  href='#'  class='button_13 green green_borderbottom md'  onclick='changeBg(this)'>"+deptsObj[i].name+"<input type='hidden' name='deptid'' value='"+deptsObj[i].ID+"'/></a>");
			}
			deptsObj=null;
			otherDept==null;
		}

		$(obj).text("收起...");
		obj.onclick=function(){
			$(".md").hide();
			swiperNested4.reInit();
			
			var nobj=$(this);
			
			nobj.text("更多...");
			this.onclick=function(){
				$(".md").show();
				swiperNested4.reInit();
				moreDept(this);
			}
		}
		swiperNested4.reInit();
	}
	function changeBg(obj){
		var hasGreen=$(obj).hasClass("green");
		var blueobjs=$("a.blue");
		if(blueobjs.length>0){
			blueobjs.removeClass("blue");
			blueobjs.removeClass("blue_borderbottom");
			blueobjs.addClass("green");
			blueobjs.addClass("green_borderbottom");
		}
		
		if(hasGreen){
			$(obj).removeClass("green");
			$(obj).removeClass("green_borderbottom");
			$(obj).addClass("blue");
			$(obj).addClass("blue_borderbottom");
		}
	}
	$(function(){
			layui.use(['layer'],function(){
				layer=layui.layer;
				
		})
		
		getData();
		var currentDate=new Date();
		var curr = currentDate.getFullYear();
		var opt = {}
		opt.date = {preset : 'date'};
		
		
		opt.datetime = { preset : 'datetime', minDate: new Date(curr-1,currentDate.getMonth()+1,currentDate.getDate(),currentDate.getHours(),currentDate.getMinutes()), maxDate: new Date(2046,7,30,15,44), stepMinute: 5  }
		opt.time = {preset : 'time'};
		opt.tree_list = {preset : 'list', labels: ['Region', 'Country', 'City']};
		opt.image_text = {preset : 'list', labels: ['Cars']};
		opt.select = {preset : 'select'};
		$('#begintime,#endtime').val('').scroller('destroy').scroller($.extend(opt['datetime'], { theme: 'default', mode: 'scroller', display: 'modal', lang:'zh' }));
		
	})

	
	var pageNum;
	var formsubjectName;
	var formtypeName;
	var formdeptid;
	function getData(formid,nextNum){

		
		
		if(formid!=undefined && formid!=null && formid!="null"){
			$(".portfolio_item,#clickmore").remove();
			formsubjectName=$("#subjectName").val();
			formtypeName=$("#typeName").val();
			formdeptid=$("a.blue").length>=0?$("a.blue input").eq(0).val():null;
			pageNum=1;
		}
		if(nextNum!=undefined){
			pageNum=nextNum
		}
		var params={
				subjectName:formsubjectName, 
				typeName:formtypeName,
				deptid:formdeptid,
				pageNum:pageNum
			}
		
		$.post("/equipment/ajaxList",params,function(data){
			
			
			
			for(var i=0;i<data.result.length;i++){
				var itemhtml='<div class="portfolio_item" id="item'+i+'">';
				itemhtml+='<div class="portfolio_image"><a rel="gallery-1" href="http://202.116.161.6:8180/equimis/inlineStream.action?path=';
				
				itemhtml+=data.result[i].PATH+'&contentType='+data.result[i].CONTENTTYPE;
				itemhtml+='" class="swipebox" title="Webdesign work"><img src="http://202.116.161.6:8180/equimis/inlineStream.action?path=';
				itemhtml+=data.result[i].PATH+'&contentType='+data.result[i].CONTENTTYPE;
				itemhtml+='" alt="" title="" border="0" /></a><a href="javascript:void(0)" class="style_a style_a2" onclick="toAppointment(this,\''+data.result[i].eid+'\')">预约</a><a href="javascript:void(0)" onclick="toCirs(\''+data.result[i].eid+'\')"  target="_blank" class="style_a2" >预约情况</a></div>';
				itemhtml+='<div class="portfolio_details comment_row2"><h4>'+data.result[i].ename+'</h4>';
				itemhtml+='<p class="titlep">编号：</p>';
				itemhtml+='<p class="textp">'+data.result[i].ecode+'</p>';
				itemhtml+='<p class="titlep">设备型号：</p>';
				itemhtml+='<p class="textp">'+data.result[i].emodel+'</p>';
				itemhtml+='<p class="titlep">仪器介绍：</p>';
				itemhtml+='<p class="textp">'+data.result[i].DESCRIPTION+'</p>';
				itemhtml+='</div><a href="#" class="ext" onclick="getDataById(this)" id="'+(Math.random()*5)+'"  eid="'+data.result[i].eid+'" style="float:right">更多...</a></div>';
				if($("#clickmore").length>0){
					$("#clickmore").before(itemhtml);
				}else{
					$(".clearfix").before(itemhtml);
				}
				
			}
			var loadStr='<a href="javascript:void(0)" onclick="getData(null,'+data.nextPageNo+')" id="clickmore">点击加载更多...</a>';
			if($("#clickmore").length>0){
				$("#clickmore").replaceWith(loadStr)
	
			}else{
				$(".clearfix").before(loadStr)
			}
			
			swiperNested4.reInit();
			$("#inputf").html('<input type="text" id="subjectName3" value="werwer" />');
			$("#subjectName3").focus();
			
		},"JSON")
	}
	function toAppointment(obj,eid){
		if(!isLogin){
			location.href="/pages/toLogin";
			
			return ;
		}
		$.post("/appointment/ajaxCheckAppRole",{eid:eid},function(data){
			if(data.retCode!=1){
				layer.alert(data.retMsg);
			}else{
				var ob=layer.open({
					  type: 2, 
					  area: ['90%','468px'],
					 
					  content: '/pages/toEditAppol?eid='+eid //这里content是一个URL，如果你不想让iframe出现滚动条，你还可以content: ['http://sentsin.com', 'no']
				});
			}
		},"JSON");

	
	}
	function getDataById(obj){
		$(obj).text("收起...");
		obj.onclick=function(){
			var nobj=$(this);
			nobj.prev().slideUp("false",function(){
				nobj.prev().remove();
				swiperNested4.swipeTo(0);
				swiperNested4.reInit();
			});
			nobj.text("更多...");
			this.onclick=function(){
				getDataById(this);
			}
		}
		var prevobj=$(obj);
		$.post("/equipment/ajaxInfo",{id:obj.getAttribute("eid")},function(data){
			
			var itemhtml='<div class="ext" style="display:none">';
			itemhtml+='<p class="titlep">仪器规格：</p>';
			itemhtml+='<p class="textp">'+data.SPECIFICATION+'</p>';
			itemhtml+='<p class="titlep">技术参数：</p>';
			itemhtml+='<p class="textp">'+data.PARAMETERS+'</p>';
			itemhtml+='<p class="titlep">主要配件：</p>';
			itemhtml+='<p class="textp">'+data.ACCESSORIES+'</p>';
			itemhtml+='<p class="titlep">主要功能及用途：</p>';
			itemhtml+='<p class="textp">'+data.MAINFUNCTION+'</p>';
			itemhtml+='<p class="titlep">使用实例：</p>';
			itemhtml+='<p class="textp">'+data.USEEXAMPLES+'</p>';

			itemhtml+='<p class="titlep">收费标准：</p>';
			itemhtml+='<p class="textp">'+data.FEES+'</p>';
			itemhtml+='<p class="titlep">所属学院：</p>';
			itemhtml+='<p class="textp">'+data.CREATOR+'</p>';
			itemhtml+='<p class="titlep">仪器价格：</p>';
			itemhtml+='<p class="textp">'+data.PRICE+'</p>';
			itemhtml+='<p class="titlep">生产厂商：</p>';
			itemhtml+='<p class="textp">'+data.VENDOR+'</p>';
			itemhtml+='<p class="titlep">存放地点：</p>';
			itemhtml+='<p class="textp">'+data.LOCATION+'</p>';
			itemhtml+='<p class="titlep">所属学科：</p>';
			itemhtml+='<p class="textp">'+data.sname+'</p>';
			itemhtml+='<p class="titlep">应用邻域：</p>';
			itemhtml+='<p class="textp">'+data.COUNTRY+'</p>';
			itemhtml+='<p class="titlep">是否收费：</p>';
			itemhtml+='<p class="textp">'+(data.ISFORFREE?"是":"否")+'</p>';
			itemhtml+='<p class="titlep">负责人信息：</p>';
			itemhtml+='<p class="textp">姓名-'+data.MANAGER+'　电话-'+data.MANAGERPHONE+'　邮箱-'+data.MANAGEREMAIL+'</p></div>';
			prevobj.before(itemhtml);
			$(obj).prev().slideDown("normal",function(){
				swiperNested4.reInit();
				
			});
			
		},"JSON");
	}
	/* ]]>*/
</script>
</body>
</html>
